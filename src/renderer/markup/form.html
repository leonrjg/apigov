<div id="form-content" class="p-4 w-full flex flex-col">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-2xl font-bold text-base-content">Add/edit component</h1>
    <button hx-get="components.html" hx-target="#main-content" hx-swap="innerHTML" class="btn btn-secondary">
      <i data-lucide="arrow-left" class="h-4 w-4 mr-1"></i>
      Back
    </button>
  </div>
  <div id="missing-mappings-container" class="mb-6"></div>
  <form id="endpoint-form" class="p-4 bg-base-200 rounded-box shadow-md mb-4">
    <input type="hidden" id="endpoint-id">
    <div class="grid grid-cols-1 md:grid-cols-5 gap-2 mb-3">
      <div class="md:col-span-1">
        <label class="text-s text-base-content/70 mb-1 block">Name</label>
        <input type="text" id="endpoint-name" class="input input-bordered input-md w-full" placeholder="Name" required>
      </div>
      <div class="relative w-full md:col-span-1">
        <label class="text-s text-base-content/50 mb-1 block">Type</label>
        <select id="component-type" class="select select-bordered select-md w-full" required>
          <option disabled selected>Select type</option>
          <option value="endpoint">Endpoint</option>
          <option value="database_table">Database Table</option>
        </select>
      </div>
      <div class="relative w-full md:col-span-3">
        <label class="text-s text-base-content/70 mb-1 block">Required components</label>
        <select multiple id="endpoint-consumes" class="w-full">
        </select>
      </div>
    </div>
    <br />
    <div>
      <br />
      <!-- Toggle between request and response -->
      <div class="flex justify-end mb-4">
        <div class="join" id="view-toggle-container">
          <input class="join-item btn" type="radio" name="view-toggle" aria-label="Input" value="input" checked />
          <input class="join-item btn" type="radio" name="view-toggle" aria-label="Output" value="output" />
        </div>
      </div>
      <div class="flex justify-between items-center mb-2">
        <h3 class="text-lg font-semibold">Fields</h3>
        <button type="button" id="add-field-btn" class="btn btn-sm btn-primary">
          <i data-lucide="plus" class="h-4 w-4 mr-1"></i>
          Field
        </button>
      </div>
      <div class="overflow-x-auto">
        <table id="fields-table" class="table table-xs table-zebra w-full">
          <thead>
            <tr>
              <th class="w-1/2">Field Path</th>
              <th class="w-1/8">Type</th>
              <th class="w-1/4">Value</th>
              <th class="w-1/8">Actions</th>
            </tr>
          </thead>
          <tbody id="fields-table-body">
            <tr>
              <td colspan="4" class="text-center text-base-content opacity-60 italic">No fields defined</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="m-4">
      <div id="jsoneditor" style="height: 400px; overflow: auto;" title="Body (JSON)"></div>
      <textarea name="endpoint-body" id="endpoint-body" rows="5" class="textarea textarea-bordered textarea-sm w-full" placeholder="Body (JSON)" style="display:none;"></textarea>
    </div>

    <!-- Mapping Table Section -->
    <div id="mapping-table-section" class="mb-4 hidden">
      <div class="flex justify-between items-center mb-2">
        <h3 class="text-lg font-semibold">Fields used by other components</h3>
      </div>
      <div class="overflow-x-auto">
        <table id="mapping-table" class="table table-xs table-zebra w-full">
          <thead>
          <tr>
            <th class="w-1/2">Field</th>
            <th class="w-1/8">External field</th>  
            <th class="w-1/4">Component</th>
            <th class="w-1/8">Actions</th>
          </tr>
          </thead>
          <tbody id="mapping-table-body">
          <tr>
            <td colspan="4" class="text-center text-base-content opacity-60 italic">No mappings defined</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
    <button type="submit" class="btn btn-primary w-full"><i data-lucide="save" class="h-4 w-4 mr-2"></i> Save</button>
  </form>
</div>

<script type="module" src="../pages/form/form.js"></script>